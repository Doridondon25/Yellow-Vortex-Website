<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Yellow-Vortex Health Report</title>
  <link rel="icon" type="image/png+xml" href="logo.png" />
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <style>
    body {
      background-image: url('ron3.png');
      background-size: cover;
      background-position: center;
      color: #333;
      padding-top: 70px;
      padding-bottom: 60px;
      overflow-x: hidden;
    }
    /* Navbar Styling */
    .navbar {
      background-color: green !important;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1030; /* Ensure it stays above other elements */
    }
  
    .navbar-brand {
      font-size: 1.5rem;
      font-weight: bold;
      color: #fff !important;
      display: flex;
      align-items: center;
    }
  
    .navbar-brand img {
      margin-right: 10px;
    }
  
    .navbar-nav .nav-link {
      font-size: 1rem;
      font-weight: 500;
      color: #fff !important;
      transition: color 0.3s ease;
    }
  
    .navbar-nav .nav-link:hover {
      color: #d4edda !important; /* Light green hover effect */
      text-decoration: underline;
    }
  
    .navbar-toggler {
      border: none;
    }
  
    .navbar-toggler-icon {
        background-color: transparent; /* Transparent background */
        font-size: 1.5rem; /* Ensure the icon is large enough */
        color: white; /* Ensure the icon is white */
        content: "\f0c9"; /* Font Awesome hamburger icon code */
    }

        .dropdown-toggle::after {
            display: none; /* Remove the default arrow */
        }

        .dropdown-menu-end {
            right: 0;
            left: auto;
        }

        /* Dropdown Menu Styling */
    .dropdown-menu {
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .dropdown-menu {
            background-color: green; /* Light background color */
            border-radius: 8px; /* Rounded corners */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Subtle shadow */
        }

        .dropdown-item {
            font-size: 1rem;
            font-weight: 500;
            color: white; /* Default text color */
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .dropdown-item:hover {
            background-color: #d4edda; /* Light green hover effect */
            color: black; /* Dark green text on hover */
        }

        .dropdown-divider {
            border-color: #ccc; /* Divider color */
        }

    .hero-section {
      text-align: center;
      padding: 20px 0;
      background-color: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      margin: 20px;
    }
    .container {
      background-color: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      padding: 20px;
      margin: 20px;
      max-width: 100%;
    }
    .medications-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .btn-add-med {
      background-color: #0d6efd;
      color: #fff;
      font-weight: 500;
      border-radius: 6px;
    }
    .med-table .table th {
      text-transform: uppercase;
      font-size: 0.9rem;
      font-weight: 600;
    }
    .fa-pen,
    .fa-trash {
      color: #e83e8c;
      cursor: pointer;
      margin-right: 10px;
    }
    .fa-trash {
      margin-right: 0;
    }
    .progress {
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-right: 20px;
    }
    .progress-bar {
      transition: width 0.5s ease-in-out;
      font-weight: bold;
    }
    #update-progress {
      background-color: #28a745;
      border: none;
      border-radius: 25px;
      padding: 10px 20px;
      font-size: 16px;
      font-weight: bold;
      color: white;
      cursor: pointer;
    }
    footer {
      display: flex;
      justify-content: center;
      text-align: center;
      padding: 20px;
      background-color: green;
      color: white;
      position: fixed;
      bottom: 0;
      width: 100%;
    }
    .container .med-table {
      padding-right: 5px !important;
      margin-right: 5px !important;
    }
    .med-table .table {
      width: 80%;
      margin: 0 auto;
      font-size: 0.9rem;
    }
  /* Styling for the Data Display Section */
  #your-data-here {
    background-color: rgba(255, 255, 255, 0.8);
    border-radius: 15px;
    padding: 20px;
    margin-top: 30px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    text-align: left;
  }

  #your-data-here h2 {
    font-size: 1.5rem;
    font-weight: bold;
    color: #007bff;
    margin-bottom: 15px;
  }

  #your-data-here span {
    font-size: 1.3rem;
    font-weight: normal;
    color: #333;
  }

  #your-data-here h2 span {
    font-size: 1.6rem;
    color: #28a745;
    font-weight: 600;
  }
  /* Styling for the Personal Information Section */
.container h3 {
  font-size: 1.8rem;
  font-weight: bold;
  color: #007bff;
  margin-bottom: 20px;

}

.container .row h5 {
  font-size: 1.1rem;
  font-weight: bold;
  color: #333;
}

.container .row p {
  font-size: 1rem;
  color: #666;
  margin-top: 5px;
}
  </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-success shadow-sm">
      <div class="container-fluid">
          <a class="navbar-brand d-flex align-items-center" href="#">
              <img src="logo.png" alt="Yellow-Vortex Logo" height="50" width="70" class="me-2">
              <span class="fw-bold">Yellow-Vortex</span>
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav ms-auto">
                  <li class="nav-item">
                      <a class="nav-link" href="home.html">Home <i class="fa-solid fa-house"></i></a>
                  <li class="nav-item">
                    <a class="nav-link" href="medication.html">Medication <i class="fa-solid fa-syringe"></i></a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="managmet.html">Management <i class="fa-solid fa-folder-plus"></i></a>
                  </li>
                  <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                          More
                      </a>
                      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="profile.html">Profile <i class="fa-solid fa-user"></i></a></li>
                          <li><a class="dropdown-item" href="appointments.html">Appointments <i class="fa-regular fa-calendar-check"></i></a></li>
                          <li><a class="dropdown-item" href="chat.html">Chats <i class="fa-solid fa-comments"></i></a></li>
                          <li><hr class="dropdown-divider"></li>
                          <li><a class="dropdown-item text-danger" href="logout.html">Logout <i class="fa-solid fa-arrow-right-from-bracket"></i></a></li>
                      </ul>
                  </li>
              </ul>
          </div>
      </div>
  </nav>

    <!-- Export Buttons -->
    <div class="text-end mt-5 me-3">
      <button id="exportDOCX" class="btn btn-primary">Export as DOCX</button>
    </div>

    <!-- Report Content -->
    <div id="reportContent">
      <!-- Hero Section -->
      <div class="hero-section mt-5 me-3">
        <h1>Health Report</h1>
        <p>Track your health, See Conclusions, and follow doctor recommendations.</p>

    <!-- Personal Data Section -->
<div class="container mt-4">
    <h3>Personal Information</h3>
    <div class="row">
      <div class="col-md-6">
        <h5>Name:</h5>
        <p id="name">John Doe</p>
    </div>
    <div class="row">
      <div class="col-md-6">
        <h5>Date of Birth:</h5>
        <p id="dob">01/01/1980</p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <h5>Gender:</h5>
        <p id="gender">Male</p>
      </div>
      <div class="col-md-6">
        <h5>Phone Number:</h5>
        <p id="phoneNumber">+1234567890</p>
      </div>
    </div>
      <!-- Medications Section -->
      <div class="container med-table">
        <div class="medications-header">
          <h3>Medications</h3>
        </div>
        <div class="card shadow-sm mt-3 me-3">
          <div class="table-responsive">
            <table class="table align-middle mb-0">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Dosage</th>
                  <th>Frequency</th>
                  <th>Time to Take</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Aspirin</td>
                  <td>100mg</td>
                  <td>Once daily</td>
                  <td>Morning</td>
                </tr>
                <tr>
                  <td>Vitamin D</td>
                  <td>1000 IU</td>
                  <td>Once daily</td>
                  <td>Morning</td>
                </tr>
                <tr>
                  <td>Ibuprofen</td>
                  <td>400mg</td>
                  <td>As needed</td>
                  <td>With food</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <hr class="my-4" />
        <div id="your-data-here">
            <h2>Heart Rate (BPM): <span id="bpmValue">Loading...</span></h2>
            <h2>ECG Average: <span id="ecgValue">Loading...</span></h2>
            <h2>Humidity (%): <span id="humidityValue">Loading...</span></h2>
            <h2>Temperature (Â°C): <span id="tempValue">Loading...</span></h2>
          </div>     
          <hr class="my-4" /> 
      </div>
  </div>



  <!-- Scripts -->
  <!-- Bootstrap Bundle with Popper (for modal and nav) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Canvas-Confetti (for celebration effect) -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.min.js"></script>
  <!-- Existing Page Scripts (medication tracker and table functions) -->
  <script>


 
  </script>
  <!-- html2canvas (for jsPDF to capture HTML) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- jsPDF Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- FileSaver.js for saving DOCX -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <!-- html-docx-js Library -->
  <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.js"></script>
  <!-- Export Functions Script -->
  <script type="module">

  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";
  import { firebaseConfig } from "./js/firebase-config.js"; 

  
  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);

  // References to the specific database paths
  const bpmRef        = ref(database, "/commands/BPM/average_bpm");
  const ecgRef        = ref(database, "/commands/ECG/average_ecg");
  const humidityRef   = ref(database, "/commands/humidity/humidity");
  const temperatureRef = ref(database, "/commands/temperature/temperature");

  // Element where data will be displayed (element containing "your data here")
  const outputElement = document.getElementById("your-data-here");

  // Set up the display with labels and placeholders for values
  outputElement.innerHTML = `Heart Rate (BPM): <span id="bpmValue"></span><br>
  ECG Average: <span id="ecgValue"></span><br>
  Humidity (%): <span id="humidityValue"></span><br>
  Temperature (&deg;C): <span id="tempValue"></span>`;

  // Get references to the span elements for updating
  const bpmValueEl      = document.getElementById("bpmValue");
  const ecgValueEl      = document.getElementById("ecgValue");
  const humidityValueEl = document.getElementById("humidityValue");
  const tempValueEl     = document.getElementById("tempValue");

  // Attach real-time listeners to each database reference
  onValue(bpmRef, (snapshot) => {
    bpmValueEl.textContent = snapshot.val();
  });
  onValue(ecgRef, (snapshot) => {
    ecgValueEl.textContent = snapshot.val();
  });
  onValue(humidityRef, (snapshot) => {
    humidityValueEl.textContent = snapshot.val();
  });
  onValue(temperatureRef, (snapshot) => {
    tempValueEl.textContent = snapshot.val();
  });


    // Make jsPDF accessible
    const { jsPDF } = window.jspdf;

    // PDF export function using jsPDF
    function exportPDF() {
      const element = document.getElementById('reportContent');
      const doc = new jsPDF('p', 'pt', 'a4');
      doc.html(element, {
        callback: function (doc) {
          doc.save('HealthReport.pdf');
        },
        margin: [20, 20, 20, 20],   // optional margins around content
        autoPaging: 'text',        // handle content split across pages
        html2canvas: { scale: 0.9 } // scale down for better fit if needed
      });
    }

    // DOCX export function using html-docx-js and FileSaver
    function exportDOCX() {
      const content = document.getElementById('reportContent').innerHTML;
      const blob = window.htmlDocx.asBlob(content);
      saveAs(blob, 'HealthReport.docx');
    }

    // Attach event listeners to export buttons
    document.getElementById('exportDOCX').addEventListener('click', exportDOCX);
  </script>
</body>
</html>